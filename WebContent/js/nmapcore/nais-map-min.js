var nm=nm||{};nm.ControlManager=function(a){this.map=a;this.keys=["attribution","mousePosition","overview","rotate","scaleLine","zoom","zoomSlider","zoomToExtent","fullScreen"];this.controls=[{status:false,control:new ol.control.Attribution()},{status:false,control:new ol.control.MousePosition({undefinedHTML:"outside",projection:"EPSG:4326",coordinateFormat:function(b){return ol.coordinate.format(b,"{y}, {x}",4)}})},{status:false,control:new ol.control.OverviewMap({collapsed:false})},{status:false,control:new ol.control.Rotate({autoHide:false})},{status:false,control:new ol.control.ScaleLine()},{status:false,control:new ol.control.Zoom()},{status:false,control:new ol.control.ZoomSlider()},{status:false,control:new ol.control.ZoomToExtent()},{status:false,control:new ol.control.FullScreen()}]};nm.ControlManager.prototype.showControl=function(b){var a=this.keys.indexOf(b);if(a>=0&&a<this.controls.length){if(this.controls[a]["status"]===false){this.map.addControl(this.controls[a]["control"]);this.controls[a]["status"]=true}}};nm.ControlManager.prototype.hideControl=function(b){var a=this.keys.indexOf(b);if(a>=0&&a<this.controls.length){if(this.controls[a]["status"]===true){this.map.removeControl(this.controls[a]["control"]);this.controls[a]["status"]=false}}};nm.ControlManager.prototype.toggleControl=function(b){var a=this.keys.indexOf(b);if(a>=0&&a<this.controls.length){if(this.controls[a]["status"]===true){this.map.removeControl(this.controls[a]["control"]);this.controls[a]["status"]=false}else{this.map.removeControl(this.controls[a]["control"]);this.controls[a]["status"]=false}}};nm.ControlManager.prototype.setControl=function(a,b){if(b){this.showControl(a)}else{this.hideControl(a)}};nm.ControlManager.prototype.setControls=function(e){for(var c=0,a=e.length;c<a;++c){var b=e[c];this.setControl(b.name,b.value)}};var nm=nm||{};nm.util=nm.util||{};nm.data=nm.data||{};nm.data.XYPoint=function(b,a){this.x=b;this.y=a;this.getOLCoordinate=function(){return[this.x,this.y]}};nm.data.LatLong=function(b,a){this.lat=b;this.lon=a;this.setLat=function(c){this.lat=c};this.getLat=function(){return this.lat};this.setLon=function(c){this.lon=c};this.getLon=function(){return this.lon};this.setLatLon=function(e,c){this.lat=e;this.lon=c};this.toMercatorCoordinate=function(){return this.toOLMercator().getOLCoordinate()};this.toOLMercator=function(){var c=nm.util.CoordinateConversionHelper.getInstance();return c.toMercator(this.lat,this.lon)};this.getOLCoordinate=function(){return[this.lon,this.lat]}};nm.util.CoordinateConversion=function(){};nm.util.CoordinateConversion.prototype.toMercator=function(c,e){var b=ol.proj.transform([e,c],"EPSG:4326","EPSG:3857");if(false){var a=e*20037508.34/180;var f=Math.log(Math.tan((90+c)*Math.PI/360))/(Math.PI/180);f=f*20037508.34/180;return new nm.data.XYPoint(a,f)}return new nm.data.XYPoint(b[0],b[1])};nm.util.CoordinateConversion.prototype.toXY=function(a,b){return ol.proj.transform([b,a],"EPSG:4326","EPSG:3857")};nm.util.CoordinateConversion.prototype.toLatLon=function(a,c){var b=ol.proj.transform([a,c],"EPSG:3857","EPSG:4326");return[b[1],b[0]]};nm.util.CoordinateConversionHelper=(function(){var a=new nm.util.CoordinateConversion();return{getInstance:function(){return a}}})();var $nmcoords=nm.util.CoordinateConversionHelper.getInstance();var nm=nm||{};var currentMapVersion="0.0.1";var logicalSession="";var ObjectType={MAPQUEST:1,OPENSTREETMAP:2,LAYER_SEL:3,LAYER_DEL:4,LAYER_TOGGLE:5,CENTER:6,ROTATE:7,ZOOM:8,FEAT_DRAW:9,FEAT_POINT:10,FEAT_LINE:11,FEAT_POLYGON:12,FEAT_CIRCLE:13,CONTROLS:14,SESSION:15,CONFIGURATION:16};var ObjectOperation={CREATE:0,REMOVE:1,SELECT:2,MOVE:3,TOGGLE:4};nm.EntityManager=function(a){};nm.EntityManager.Message=function(a){this.objectType=a||-1;this.session=logicalSession;this.userName="";this.mapVersion=currentMapVersion||"1.0.0"};nm.EntityManager.MapQuestLayer=function(a,b){args=[a,ObjectType.MAPQUEST];nm.EntityManager.Layer.apply(this,args);this.type=b};nm.EntityManager.OSMLayer=function(a){args=[a,ObjectType.OPENSTREETMAP];nm.EntityManager.Layer.apply(this,args)};nm.EntityManager.Layer=function(a,b){args=[b,3];nm.EntityManager.Message.apply(this,args);this.name=a};nm.EntityManager.Center=function(a,b){args=[ObjectType.CENTER,1];nm.EntityManager.Message.apply(this,args);this.latitude=a;this.longitude=b};nm.EntityManager.Rotate=function(a){args=[ObjectType.ROTATE,1];nm.EntityManager.Message.apply(this,args);this.angle=a};nm.EntityManager.Zoom=function(a){args=[ObjectType.ZOOM,1];nm.EntityManager.Message.apply(this,args);this.level=a};nm.EntityManager.FeatureDraw=function(a,b){args=[ObjectType.FEAT_DRAW,1];nm.EntityManager.Message.apply(this,args);this.name=a;this.type=b};nm.EntityManager.Feature=function(a,b,c){args=[b,1];nm.EntityManager.Message.apply(this,args);this.name=a;this.operation=c};nm.EntityManager.FeatureMove=function(a,b,c){args=[a,b,ObjectOperation.MOVE];nm.EntityManager.Feature.apply(this,args);this.setDelta(c)};nm.EntityManager.FeatureMove.prototype.setDelta=function(a){this.delta=[];this.delta.push(a[0]);this.delta.push(a[1])};nm.EntityManager.FeatureMove.prototype.getDelta=function(){var a=[];a.push(this.delta[0]);a.push(this.delta[1]);return a};nm.EntityManager.FeatureMove.prototype.setType=function(a){this.objectType=a};nm.EntityManager.FeatureMove.prototype.setName=function(a){this.name=a};nm.EntityManager.Point=function(a,b,c){args=[a,ObjectType.FEAT_POINT,c||ObjectOperation.CREATE];nm.EntityManager.Feature.apply(this,args);this.setCoords(b)};nm.EntityManager.Point.prototype.setCoords=function(a){this.coordinates=[];this.coordinates.push([a[0][0],a[0][1]])};nm.EntityManager.Point.prototype.getCoords=function(){var b=[];for(var e=0,a=this.coordinates.length;e<a;++e){b.push([this.coordinates[e][0],this.coordinates[e][1]])}return b};nm.EntityManager.Point.prototype.setOperation=function(a){this.operation=a};nm.EntityManager.Line=function(a,b,c){args=[a,ObjectType.FEAT_LINE,c||ObjectOperation.CREATE];nm.EntityManager.Feature.apply(this,args);this.setCoords(b)};nm.EntityManager.Line.prototype.setCoords=function(b){this.coordinates=[];for(var c=0,a=b.length;c<a;++c){this.coordinates.push([b[c][0],b[c][1]])}};nm.EntityManager.Line.prototype.getCoords=function(){var b=[];for(var e=0,a=this.coordinates.length;e<a;++e){b.push([this.coordinates[e][0],this.coordinates[e][1]])}return b};nm.EntityManager.Line.prototype.setOperation=function(a){this.operation=a};nm.EntityManager.Polygon=function(a,b,c){args=[a,ObjectType.FEAT_POLYGON,c||ObjectOperation.CREATE];nm.EntityManager.Feature.apply(this,args);this.setCoords(b)};nm.EntityManager.Polygon.prototype.setCoords=function(b){this.coordinates=[];for(var c=0,a=b.length;c<a;++c){this.coordinates.push([b[c][0],b[c][1]])}};nm.EntityManager.Polygon.prototype.getCoords=function(){var b=[];for(var e=0,a=this.coordinates.length;e<a;++e){b.push([this.coordinates[e][0],this.coordinates[e][1]])}return b};nm.EntityManager.Polygon.prototype.setOperation=function(a){this.operation=a};nm.EntityManager.Circle=function(c,b,a,e){args=[c,ObjectType.FEAT_CIRCLE,e||ObjectOperation.CREATE];nm.EntityManager.Feature.apply(this,args);this.setCoords(b);this.radius=a};nm.EntityManager.Circle.prototype.setCoords=function(b){this.center=[];for(var c=0,a=b.length;c<a;++c){this.center.push([b[c][0],b[c][1]])}};nm.EntityManager.Circle.prototype.getCoords=function(){var b=[];for(var e=0,a=this.coordinates.length;e<a;++e){b.push([this.coordinates[e][0],this.coordinates[e][1]])}return b};nm.EntityManager.Circle.prototype.setRadius=function(a){this.radius=a};nm.EntityManager.Circle.prototype.getRadius=function(){return this.radius};nm.EntityManager.Circle.prototype.setOperation=function(a){this.operation=a};nm.EntityManager.Controls=function(){args=[ObjectType.CONTROLS,1];nm.EntityManager.Message.apply(this,args);this.attribution=false;this.mousePosition=false;this.overview=false;this.rotate=false;this.scaleLine=false;this.zoom=false;this.zoomSlider=false;this.zoomToExtent=false;this.fullScreen=false};nm.EntityManager.Controls.prototype.setControl=function(a,b){this[a]=b};nm.EntityManager.Controls.prototype.toggleControl=function(a){this[a]=this[a]===false};nm.EntityManager.Controls.prototype.setControls=function(e){for(var c=0,a=e.length;c<a;++c){var b=e[c];this[b.name]=b.value}};nm.EntityManager.Session=function(a){args=[ObjectType.SESSION,1];nm.EntityManager.Message.apply(this,args);this.oper=a;this.valid=true;this.value=""};nm.EntityManager.Session.prototype.getOper=function(){return this.oper};nm.EntityManager.Session.prototype.isValid=function(){return this.valid};nm.EntityManager.Session.prototype.setValid=function(a){this.valid=a};nm.EntityManager.Session.prototype.getValue=function(){return this.value};nm.EntityManager.Session.prototype.setValue=function(a){this.value=a};nm.EntityManager.prototype.setSession=function(a){logicalSession=a};nm.EntityManager.prototype.getSession=function(){return logicalSession};nm.EntityManager.prototype.newFeature=function(a,b,c){return new nm.EntityManager.Feature(a,b,c)};nm.EntityManager.prototype.newFeatureMove=function(a,b,c){return new nm.EntityManager.FeatureMove(a,b,c)};nm.EntityManager.prototype.newPoint=function(a,b){return new nm.EntityManager.Point(a,b)};nm.EntityManager.prototype.newLine=function(a,b){return new nm.EntityManager.Line(a,b)};nm.EntityManager.prototype.newPolygon=function(a,b){return new nm.EntityManager.Polygon(a,b)};nm.EntityManager.prototype.newCircle=function(c,b,a){return new nm.EntityManager.Circle(c,b,a)};nm.EntityManager.prototype.newLayer=function(a,b){return new nm.EntityManager.Layer(a,b)};nm.EntityManager.prototype.newMapQuestLayer=function(a,b){return new nm.EntityManager.MapQuestLayer(a,b)};nm.EntityManager.prototype.newOSMLayer=function(a){return new nm.EntityManager.OSMLayer(a)};nm.EntityManager.prototype.newCenter=function(a,b){return new nm.EntityManager.Center(a,b)};nm.EntityManager.prototype.newRotate=function(a){return new nm.EntityManager.Rotate(a)};nm.EntityManager.prototype.newZoom=function(a){return new nm.EntityManager.Zoom(a)};nm.EntityManager.prototype.newFeatureDraw=function(a,b){return new nm.EntityManager.FeatureDraw(a,b)};nm.EntityManager.prototype.newControls=function(){return new nm.EntityManager.Controls()};nm.EntityManager.prototype.newSession=function(a){return new nm.EntityManager.Session(a)};var nm=nm||{};var vectorLayerName="nais-map-core-vector-layer";nm.FeatureManager=function(b){this.map=b;this.source=new ol.source.Vector({projection:"EPSG:4326"});this.defaultStyle=new ol.style.Style({fill:new ol.style.Fill({color:"rgba(0, 0, 255, 0.6)"}),stroke:new ol.style.Stroke({color:[255,0,0,1],width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})});var a=new ol.layer.Vector({source:this.source,style:this.defaultStyle,name:vectorLayerName});this.map.addLayer(a);this.interactions=new Hashtable()};nm.FeatureManager.prototype.drawFeature=function(b,c){var a=new ol.interaction.Draw({source:this.source,type:c});this.interactions.put(b,a);this.map.addInteraction(a);return a};nm.FeatureManager.prototype.stopDraw=function(){this.interactions.moveFirst();if(this.interactions.next()){var a=this.interactions.getValue();this.map.removeInteraction(a)}};nm.FeatureManager.prototype.getFeature=function(a){var b=this.source.getFeatures();for(var g=0,e=b.length;g<e;++g){var c=b[g];if(c.get("name")===a){return c}}return null};nm.FeatureManager.prototype.getFeaturePoint=function(a){var b=this.getFeature(a);if(b!==null){var e=b.getGeometry().getFirstCoordinate();var c=$nmcoords.toLatLon(e[0],e[1]);return[c[0].toString(),c[1].toString()]}return null};nm.FeatureManager.prototype.addPoint=function(a,e){if(e.length>0){var c=$nmcoords.toXY(parseFloat(e[0][0]),parseFloat(e[0][1]));var b=new ol.Feature({geometry:new ol.geom.Point(c),name:a});this.source.addFeature(b)}};nm.FeatureManager.prototype.addLine=function(a,e){var c=[];for(d=0,dl=e.length;d<dl;++d){c[d]=$nmcoords.toXY(parseFloat(e[d][0]),parseFloat(e[d][1]))}var b=new ol.Feature({geometry:new ol.geom.LineString(c),name:a});this.source.addFeature(b)};nm.FeatureManager.prototype.addPolygon=function(b,f){var e=[];e.push([]);for(var g=0,a=f.length;g<a;g++){e[0].push($nmcoords.toXY(parseFloat(f[g][0]),parseFloat(f[g][1])))}var c=new ol.Feature({geometry:new ol.geom.Polygon(e),name:b});this.source.addFeature(c)};nm.FeatureManager.prototype.addCircle=function(c,b,a){var f=$nmcoords.toXY(parseFloat(b[0]),parseFloat(b[1]));var e=new ol.Feature({geometry:new ol.geom.Circle(f,parseFloat(a)),name:c});this.source.addFeature(e)};nm.FeatureManager.prototype.select=function(a){};nm.FeatureManager.prototype.move=function(a,n){var g=this.getFeature(a);if(g!==null){var j=$nmcoords.toXY(parseFloat(n[0]),parseFloat(n[1]));var f=g.getGeometry();var b=f.getType();var k;if(b===ol.geom.GeometryType.CIRCLE){k=f.getCenter();ol.coordinate.add(k,j);f.setCenter(k)}else{if(b===ol.geom.GeometryType.GEOMETRY_COLLECTION){}else{var e=true;k=f.getCoordinates();if(b===ol.geom.GeometryType.POLYGON){for(var h=0,m=k[0].length;h<m;++h){ol.coordinate.add(k[0][h],j)}}else{if(b===ol.geom.GeometryType.LINE_STRING){for(var h=0,m=k.length;h<m;++h){ol.coordinate.add(k[h],j)}}else{if(b===ol.geom.GeometryType.POINT){ol.coordinate.add(k,j)}else{e=false}}}if(e){f.setCoordinates(k);g.setGeometry(f)}}}}};nm.FeatureManager.prototype.remove=function(a){var b=this.source.getFeatures();for(var g=0,e=b.length;g<e;++g){var c=b[g];if(c.get("name")===a){this.source.removeFeature(c);break}}};nm.FeatureManager.prototype.setOnTop=function(){var e=this.map.getLayers();var c=e.getLength();for(var a=0;a<c;a++){if(vectorLayerName===e.item(a).get("name")){var b=e.item(c-1);e.setAt(c-1,this.layer);e.setAt(a,b);break}}};nm.FeatureManager.prototype.setVisible=function(a){this.layer.setVisible(a)};nm.FeatureManager.prototype.toggleVisibility=function(){this.layer.setVisible(this.layer.getVisible()===false)};Hashtable.prototype.hash=null;Hashtable.prototype.keys=null;Hashtable.prototype.location=null;function Hashtable(){this.hash=new Array();this.keys=new Array();this.location=0}Hashtable.prototype.put=function(a,b){if(b==null){return}if(this.hash[a]==null){this.keys[this.keys.length]=a}this.hash[a]=b};Hashtable.prototype.get=function(a){return this.hash[a]};Hashtable.prototype.remove=function(b){for(var a=0;a<this.keys.length;a++){if(b==this.keys[a]){this.hash[this.keys[a]]=null;this.keys.splice(a,1);return}}};Hashtable.prototype.size=function(){return this.keys.length};Hashtable.prototype.populateItems=function(){};Hashtable.prototype.next=function(){if(++this.location<this.keys.length){return true}else{return false}};Hashtable.prototype.moveFirst=function(){try{this.location=-1}catch(a){}};Hashtable.prototype.moveLast=function(){try{this.location=this.keys.length-1}catch(a){}};Hashtable.prototype.getKey=function(){try{return this.keys[this.location]}catch(a){return null}};Hashtable.prototype.getValue=function(){try{return this.hash[this.keys[this.location]]}catch(a){return null}};Hashtable.prototype.getKeyOfValue=function(b){for(var a=0;a<this.keys.length;a++){if(this.hash[this.keys[a]]==b){return this.keys[a]}}return null};Hashtable.prototype.elements=function(){var b=new Array(this.keys.length);try{for(i=0;i<this.keys.length;i++){b[i]=this.get(this.keys[i])}}catch(a){}finally{return b}};Hashtable.prototype.toString=function(){if(this.keys===null){return""}try{var c=new Array(this.keys.length);c[c.length]="{";for(var b=0;b<this.keys.length;b++){c[c.length]=this.keys[b];c[c.length]="=";var a=this.hash[this.keys[b]];if(a){c[c.length]=a.toString()}else{c[c.length]="null"}if(b!=this.keys.length-1){c[c.length]=", "}}}catch(f){}finally{c[c.length]="}"}return c.join("")};Hashtable.prototype.add=function(a){try{a.moveFirst();while(a.next()){var b=a.getKey();this.hash[b]=a.getValue();if(this.get(b)!=null){this.keys[this.keys.length]=b}}}catch(c){}finally{return this}};var nm=nm||{};var defaultViewCenter=[0,0];nm.MapManager=function(a){this.mapImpl=null;this.featureManager=null;this.controlManager=null;this.mapController=a;this.layerMap=new Hashtable();this.objectManagerMap=new Hashtable()};nm.MapManager.prototype.createMapOptions=function(a){this.mapImpl=null;try{this.mapImpl=new ol.Map(a)}catch(b){}return this.mapImpl};nm.MapManager.prototype.createMap=function(c){var b=c||"mapContainer";var a={view:new ol.View({center:[0,0],zoom:1}),controls:[],target:b};return this.createMapOptions(a)};nm.MapManager.prototype.getMap=function(){return this.mapImpl};nm.MapManager.prototype.setCenter=function(b,c){var a=$nmcoords.toXY(parseFloat(b),parseFloat(c));this.mapImpl.getView().setCenter(a)};nm.MapManager.prototype.setRotate=function(a){this.mapImpl.getView().setRotation(a*Math.PI/180)};nm.MapManager.prototype.setZoom=function(a){this.mapImpl.getView().setZoom(a)};nm.MapManager.prototype.addLayer=function(a,b){if(this.layerMap.get(a)===undefined){this.layerMap.put(a,b);this.mapImpl.addLayer(b)}};nm.MapManager.prototype.addMapQuestLayer=function(a,c){if(this.mapImpl!==null&&typeof(this.mapImpl)!=="undefined"){var b=new ol.layer.Tile({source:new ol.source.MapQuest({layer:c}),name:a});this.addLayer(a,b)}};nm.MapManager.prototype.addOpenStreetMapLayer=function(a){if(this.mapImpl!==null&&typeof(this.mapImpl)!=="undefined"){var b=new ol.layer.Tile({source:new ol.source.OSM({attributions:[new ol.Attribution({html:'All maps &copy; <a href="http://www.openstreetmap.org/">OpenStreetMap</a>'}),ol.source.OSM.ATTRIBUTION],url:"http://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),name:a});this.addLayer(a,b)}};nm.MapManager.prototype.getLayerByName=function(b){var e=map.getLayers();for(var a=0;a<e.getLength();a++){var c=e.item(a);if(c.get("name")===b){return c}}return null};nm.MapManager.prototype.removeLayer=function(a){this.mapImpl.removeLayer(a);this.layerMap.remove(a.name)};nm.MapManager.prototype.removeLayerByName=function(b){var a=this.layerMap.get(b);this.removeLayer(a)};nm.MapManager.prototype.setLayerVisible=function(c,b){var a=this.layerMap.get(c);if(typeof a!=="undefined"){a.setVisible(b)}};nm.MapManager.prototype.toggleLayerVisibility=function(b){var a=this.layerMap.get(b);if(typeof a!=="undefined"){a.setVisible(a.getVisible()===false)}};nm.MapManager.prototype.selectLayer=function(b){var g=this.mapImpl.getLayers();var f=g.getLength();var e=g.item(f-1);for(var a=0;a<f;a++){var c=g.item(a);console.log("Layer "+a+": "+c.get("name"));if(c.get("name")===b){console.log("Exchange with layer: "+e.get("name"));g.setAt(f-1,c);g.setAt(a,e);break}}};nm.MapManager.prototype.getObjectManager=function(a){return this.objectManagerMap.get(a)};nm.MapManager.prototype.createObjectLayer=function(b){var e=new ol.source.Vector();var c=new ol.layer.Vector({source:e});c.name=b;var a=new nm.ObjectManager(c);this.objectManagerMap.put(b,a);return a};nm.MapManager.prototype.getFeatureManager=function(){if(this.featureManager===null){this.featureManager=new nm.FeatureManager(this.mapImpl)}return this.featureManager};nm.MapManager.prototype.getControlManager=function(){if(this.controlManager===null){this.controlManager=new nm.ControlManager(this.mapImpl)}return this.controlManager};nm.MapManager.prototype.enableMousePosition=function(a){if(this.mapImpl===null){return}if(a){var c=new ol.control.MousePosition({coordinateFormat:ol.coordinate.createStringXY(4),projection:"EPSG:4326",undefinedHTML:"&nbsp;"});this.mapImpl.getControls().extend([c])}else{var e=this.mapImpl.getControls();var b=e.getLength();for(l=0;l<b;l++){if(e.item(l) instanceof ol.control.MousePosition){e.removeAt(l);break}}}};nm.MapManager.prototype.set3DStatus=function(a){};var nm=nm||{};nm.isDef=function(a){return typeof a!=="undefined"&&a!==null};nm.Controller=(function(){this.mapManager=null;this.objectManager=null;this.entityManager=null;function b(){if(this.mapManager===null||typeof(this.mapManager)==="undefined"){this.mapManager=new nm.MapManager(this)}return this.mapManager}function a(){if(this.entityManager===null||typeof(this.entityManager)==="undefined"){this.entityManager=new nm.EntityManager(this)}return this.entityManager}return{getMapManager:b,getEntityManager:a}})();var $nmc=nm.Controller;var $nmm=nm.Controller.getMapManager();var $nme=nm.Controller.getEntityManager();var nm=nm||{};nm.ObjectManager=function(b,c){this.layer=b;this.layerName=b.name||"objectLayer";this.objectMap=new Hashtable();var a=nm.isDef(c)?c:{};this.defaultLabelXOffset=nm.isDef(a.labelXOffset)||20;this.defaultLabelYOffset=nm.isDef(a.labelYOffset)||-20;this.defaultLabelFont=nm.isDef(a.labelFont)||"12px Calibri,sans-serif"};nm.ObjectManager.prototype.getLayer=function(){return this.layer};nm.ObjectManager.prototype.updateObjectPosition=function(a,g){var b=this.objectMap.get(a);var e=g.toOLMercator().getOLCoordinate();var f=new ol.geom.Point(e);var c=this.layer.getSource();b.setGeometry(f)};nm.ObjectManager.prototype.addObject=function(o,q,k,m,s){var p=m.toOLMercator().getOLCoordinate();var e={geometry:new ol.geom.Point(p),name:q};var j=nm.isDef(s)?s:{};var h=j.labelXOffset||this.defaultLabelXOffset;var g=j.labelYOffset||this.defaultLabelYOffset;var c=j.labelFont||this.defaultLabelFont;var b=new ol.Feature(e);var n=new ol.style.Icon({src:k,opacity:0.75});var r=new ol.style.Text({fill:new ol.style.Fill({color:"#fff"}),text:q,font:c,offsetY:g,offsetX:h});var f=[new ol.style.Style({image:n}),new ol.style.Style({text:r})];b.setStyle(f);this.objectMap.put(o,b);var a=this.layer.getSource();a.addFeature(b)};var nm=nm||{};var ByteBuffer=bytebuffer||{};var bb=new ByteBuffer().writeIString("Hello world!").flip();console.log(bb.readIString()+" from ByteBuffer.js");nm.ProtocolManager=(function(){var a;function b(){if(nm.ProtocolManager.instance===null||typeof(nm.ProtocolManager.instance)==="undefined"){nm.ProtocolManager.instance=this;nm.ProtocolManager.webSocketMap=new Hashtable()}}function c(e){b();objectType=bb.readInt()}return{locate:locate}})();var nm=nm||{};nm.WebSocket=function(a){this.wsUri=a};nm.WebSocket.prototype.connect=function(){this.websocket=new WebSocket(this.wsUri);this.websocket.onopen=this.onOpen;this.websocket.onmessage=this.onMessage;this.websocket.onerror=this.onError};nm.WebSocket.prototype.onOpen=function(){writeToScreen("Connected to Endpoint!")};nm.WebSocket.prototype.onMessage=function(a){if(a.data instanceof ArrayBuffer){writeToScreen("Binary Received: "+a.data)}else{if(typeof a.data==="string"){writeToScreen("Message Received: "+a.data)}}};nm.WebSocket.prototype.onError=function(a){writeToScreen("ERROR: "+a.data)};nm.WebSocket.prototype.send=function(a){this.websocket.send(a)};nm.WebSocketRegistry=(function(){var a;var b;function f(){if(nm.WebSocketRegistry.instance===null||typeof(nm.WebSocketRegistry.instance)==="undefined"){nm.WebSocketRegistry.instance=this;nm.WebSocketRegistry.webSocketMap=new Hashtable()}}function e(g){f();return this.webSocketMap.get(g)}function c(g,j){f();var h=new nm.WebSocket(j);this.webSocketMap.put(g,h);return h}return{locate:e,createRegistry:c}})();(function(b){function a(h){function j(g,e,k){"undefined"===typeof g&&(g=j.DEFAULT_CAPACITY);"undefined"===typeof e&&(e=j.DEFAULT_ENDIAN);"undefined"===typeof k&&(k=j.DEFAULT_NOASSERT);if(!k){g|=0;if(0>g){throw RangeError("Illegal capacity")}e=!!e;k=!!k}this.buffer=0===g?r:new ArrayBuffer(g);this.view=0===g?null:new DataView(this.buffer);this.offset=0;this.markedOffset=-1;this.limit=g;this.littleEndian="undefined"!==typeof e?!!e:!1;this.noAssert=!!k}function c(g){var e=0;return function(){return e<g.length?g.charCodeAt(e++):null}}function q(){var g=[],e=[];return function(){if(0===arguments.length){return e.join("")+p.apply(String,g)}1024<g.length+arguments.length&&(e.push(p.apply(String,g)),g.length=0);Array.prototype.push.apply(g,arguments)}}j.VERSION="3.5.4";j.LITTLE_ENDIAN=!0;j.BIG_ENDIAN=!1;j.DEFAULT_CAPACITY=16;j.DEFAULT_ENDIAN=j.BIG_ENDIAN;j.DEFAULT_NOASSERT=!1;j.Long=h||null;var n=j.prototype,r=new ArrayBuffer(0),p=String.fromCharCode;j.allocate=function(g,e,k){return new j(g,e,k)};j.concat=function(k,g,w,u){if("boolean"===typeof g||"string"!==typeof g){u=w,w=g,g=void 0}for(var s=0,v=0,m=k.length,t;v<m;++v){j.isByteBuffer(k[v])||(k[v]=j.wrap(k[v],g)),t=k[v].limit-k[v].offset,0<t&&(s+=t)}if(0===s){return new j(0,w,u)}g=new j(s,w,u);u=new Uint8Array(g.buffer);for(v=0;v<m;){w=k[v++],t=w.limit-w.offset,0>=t||(u.set((new Uint8Array(w.buffer)).subarray(w.offset,w.limit),g.offset),g.offset+=t)}g.limit=g.offset;g.offset=0;return g};j.isByteBuffer=function(e){return !0===(e&&e instanceof j)};j.type=function(){return ArrayBuffer};j.wrap=function(g,e,m,k){"string"!==typeof e&&(k=m,m=e,e=void 0);if("string"===typeof g){switch("undefined"===typeof e&&(e="utf8"),e){case"base64":return j.fromBase64(g,m);case"hex":return j.fromHex(g,m);case"binary":return j.fromBinary(g,m);case"utf8":return j.fromUTF8(g,m);case"debug":return j.fromDebug(g,m);default:throw Error("Unsupported encoding: "+e)}}if(null===g||"object"!==typeof g){throw TypeError("Illegal buffer")}if(j.isByteBuffer(g)){return e=n.clone.call(g),e.markedOffset=-1,e}if(g instanceof Uint8Array){e=new j(0,m,k),0<g.length&&(e.buffer=g.buffer,e.offset=g.byteOffset,e.limit=g.byteOffset+g.length,e.view=0<g.length?new DataView(g.buffer):null)}else{if(g instanceof ArrayBuffer){e=new j(0,m,k),0<g.byteLength&&(e.buffer=g,e.offset=0,e.limit=g.byteLength,e.view=0<g.byteLength?new DataView(g):null)}else{if("[object Array]"===Object.prototype.toString.call(g)){for(e=new j(g.length,m,k),e.limit=g.length,i=0;i<g.length;++i){e.view.setUint8(i,g[i])}}else{throw TypeError("Illegal buffer")}}}return e};n.writeInt8=function(g,e){var m="undefined"===typeof e;m&&(e=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal value: "+g+" (not an integer)")}g|=0;if("number"!==typeof e||0!==e%1){throw TypeError("Illegal offset: "+e+" (not an integer)")}e>>>=0;if(0>e||e+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}}e+=1;var k=this.buffer.byteLength;e>k&&this.resize((k*=2)>e?k:e);this.view.setInt8(e-1,g);m&&(this.offset+=1);return this};n.writeByte=n.writeInt8;n.readInt8=function(g){var e="undefined"===typeof g;e&&(g=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal offset: "+g+" (not an integer)")}g>>>=0;if(0>g||g+1>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+g+" (+1) <= "+this.buffer.byteLength)}}g=this.view.getInt8(g);e&&(this.offset+=1);return g};n.readByte=n.readInt8;n.writeUint8=function(g,e){var m="undefined"===typeof e;m&&(e=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal value: "+g+" (not an integer)")}g>>>=0;if("number"!==typeof e||0!==e%1){throw TypeError("Illegal offset: "+e+" (not an integer)")}e>>>=0;if(0>e||e+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}}e+=1;var k=this.buffer.byteLength;e>k&&this.resize((k*=2)>e?k:e);this.view.setUint8(e-1,g);m&&(this.offset+=1);return this};n.readUint8=function(g){var e="undefined"===typeof g;e&&(g=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal offset: "+g+" (not an integer)")}g>>>=0;if(0>g||g+1>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+g+" (+1) <= "+this.buffer.byteLength)}}g=this.view.getUint8(g);e&&(this.offset+=1);return g};n.writeInt16=function(g,e){var m="undefined"===typeof e;m&&(e=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal value: "+g+" (not an integer)")}g|=0;if("number"!==typeof e||0!==e%1){throw TypeError("Illegal offset: "+e+" (not an integer)")}e>>>=0;if(0>e||e+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}}e+=2;var k=this.buffer.byteLength;e>k&&this.resize((k*=2)>e?k:e);this.view.setInt16(e-2,g,this.littleEndian);m&&(this.offset+=2);return this};n.writeShort=n.writeInt16;n.readInt16=function(g){var e="undefined"===typeof g;e&&(g=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal offset: "+g+" (not an integer)")}g>>>=0;if(0>g||g+2>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+g+" (+2) <= "+this.buffer.byteLength)}}g=this.view.getInt16(g,this.littleEndian);e&&(this.offset+=2);return g};n.readShort=n.readInt16;n.writeUint16=function(g,e){var m="undefined"===typeof e;m&&(e=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal value: "+g+" (not an integer)")}g>>>=0;if("number"!==typeof e||0!==e%1){throw TypeError("Illegal offset: "+e+" (not an integer)")}e>>>=0;if(0>e||e+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}}e+=2;var k=this.buffer.byteLength;e>k&&this.resize((k*=2)>e?k:e);this.view.setUint16(e-2,g,this.littleEndian);m&&(this.offset+=2);return this};n.readUint16=function(g){var e="undefined"===typeof g;e&&(g=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal offset: "+g+" (not an integer)")}g>>>=0;if(0>g||g+2>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+g+" (+2) <= "+this.buffer.byteLength)}}g=this.view.getUint16(g,this.littleEndian);e&&(this.offset+=2);return g};n.writeInt32=function(g,e){var m="undefined"===typeof e;m&&(e=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal value: "+g+" (not an integer)")}g|=0;if("number"!==typeof e||0!==e%1){throw TypeError("Illegal offset: "+e+" (not an integer)")}e>>>=0;if(0>e||e+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}}e+=4;var k=this.buffer.byteLength;e>k&&this.resize((k*=2)>e?k:e);this.view.setInt32(e-4,g,this.littleEndian);m&&(this.offset+=4);return this};n.writeInt=n.writeInt32;n.readInt32=function(g){var e="undefined"===typeof g;e&&(g=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal offset: "+g+" (not an integer)")}g>>>=0;if(0>g||g+4>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+g+" (+4) <= "+this.buffer.byteLength)}}g=this.view.getInt32(g,this.littleEndian);e&&(this.offset+=4);return g};n.readInt=n.readInt32;n.writeUint32=function(g,e){var m="undefined"===typeof e;m&&(e=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal value: "+g+" (not an integer)")}g>>>=0;if("number"!==typeof e||0!==e%1){throw TypeError("Illegal offset: "+e+" (not an integer)")}e>>>=0;if(0>e||e+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}}e+=4;var k=this.buffer.byteLength;e>k&&this.resize((k*=2)>e?k:e);this.view.setUint32(e-4,g,this.littleEndian);m&&(this.offset+=4);return this};n.readUint32=function(g){var e="undefined"===typeof g;e&&(g=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal offset: "+g+" (not an integer)")}g>>>=0;if(0>g||g+4>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+g+" (+4) <= "+this.buffer.byteLength)}}g=this.view.getUint32(g,this.littleEndian);e&&(this.offset+=4);return g};h&&(n.writeInt64=function(g,e){var m="undefined"===typeof e;m&&(e=this.offset);if(!this.noAssert){if("number"===typeof g){g=h.fromNumber(g)}else{if(!(g&&g instanceof h)){throw TypeError("Illegal value: "+g+" (not an integer or Long)")}}if("number"!==typeof e||0!==e%1){throw TypeError("Illegal offset: "+e+" (not an integer)")}e>>>=0;if(0>e||e+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}}"number"===typeof g&&(g=h.fromNumber(g));e+=8;var k=this.buffer.byteLength;e>k&&this.resize((k*=2)>e?k:e);e-=8;this.littleEndian?(this.view.setInt32(e,g.low,!0),this.view.setInt32(e+4,g.high,!0)):(this.view.setInt32(e,g.high,!1),this.view.setInt32(e+4,g.low,!1));m&&(this.offset+=8);return this},n.writeLong=n.writeInt64,n.readInt64=function(g){var e="undefined"===typeof g;e&&(g=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal offset: "+g+" (not an integer)")}g>>>=0;if(0>g||g+8>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+g+" (+8) <= "+this.buffer.byteLength)}}g=this.littleEndian?new h(this.view.getInt32(g,!0),this.view.getInt32(g+4,!0),!1):new h(this.view.getInt32(g+4,!1),this.view.getInt32(g,!1),!1);e&&(this.offset+=8);return g},n.readLong=n.readInt64,n.writeUint64=function(g,e){var m="undefined"===typeof e;m&&(e=this.offset);if(!this.noAssert){if("number"===typeof g){g=h.fromNumber(g)}else{if(!(g&&g instanceof h)){throw TypeError("Illegal value: "+g+" (not an integer or Long)")}}if("number"!==typeof e||0!==e%1){throw TypeError("Illegal offset: "+e+" (not an integer)")}e>>>=0;if(0>e||e+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}}"number"===typeof g&&(g=h.fromNumber(g));e+=8;var k=this.buffer.byteLength;e>k&&this.resize((k*=2)>e?k:e);e-=8;this.littleEndian?(this.view.setInt32(e,g.low,!0),this.view.setInt32(e+4,g.high,!0)):(this.view.setInt32(e,g.high,!1),this.view.setInt32(e+4,g.low,!1));m&&(this.offset+=8);return this},n.readUint64=function(g){var e="undefined"===typeof g;e&&(g=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal offset: "+g+" (not an integer)")}g>>>=0;if(0>g||g+8>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+g+" (+8) <= "+this.buffer.byteLength)}}g=this.littleEndian?new h(this.view.getInt32(g,!0),this.view.getInt32(g+4,!0),!0):new h(this.view.getInt32(g+4,!1),this.view.getInt32(g,!1),!0);e&&(this.offset+=8);return g});n.writeFloat32=function(g,e){var m="undefined"===typeof e;m&&(e=this.offset);if(!this.noAssert){if("number"!==typeof g){throw TypeError("Illegal value: "+g+" (not a number)")}if("number"!==typeof e||0!==e%1){throw TypeError("Illegal offset: "+e+" (not an integer)")}e>>>=0;if(0>e||e+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}}e+=4;var k=this.buffer.byteLength;e>k&&this.resize((k*=2)>e?k:e);this.view.setFloat32(e-4,g,this.littleEndian);m&&(this.offset+=4);return this};n.writeFloat=n.writeFloat32;n.readFloat32=function(g){var e="undefined"===typeof g;e&&(g=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal offset: "+g+" (not an integer)")}g>>>=0;if(0>g||g+4>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+g+" (+4) <= "+this.buffer.byteLength)}}g=this.view.getFloat32(g,this.littleEndian);e&&(this.offset+=4);return g};n.readFloat=n.readFloat32;n.writeFloat64=function(g,e){var m="undefined"===typeof e;m&&(e=this.offset);if(!this.noAssert){if("number"!==typeof g){throw TypeError("Illegal value: "+g+" (not a number)")}if("number"!==typeof e||0!==e%1){throw TypeError("Illegal offset: "+e+" (not an integer)")}e>>>=0;if(0>e||e+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}}e+=8;var k=this.buffer.byteLength;e>k&&this.resize((k*=2)>e?k:e);this.view.setFloat64(e-8,g,this.littleEndian);m&&(this.offset+=8);return this};n.writeDouble=n.writeFloat64;n.readFloat64=function(g){var e="undefined"===typeof g;e&&(g=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal offset: "+g+" (not an integer)")}g>>>=0;if(0>g||g+8>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+g+" (+8) <= "+this.buffer.byteLength)}}g=this.view.getFloat64(g,this.littleEndian);e&&(this.offset+=8);return g};n.readDouble=n.readFloat64;j.MAX_VARINT32_BYTES=5;j.calculateVarint32=function(e){e>>>=0;return 128>e?1:16384>e?2:2097152>e?3:268435456>e?4:5};j.zigZagEncode32=function(e){return((e|=0)<<1^e>>31)>>>0};j.zigZagDecode32=function(e){return e>>>1^-(e&1)|0};n.writeVarint32=function(g,e){var s="undefined"===typeof e;s&&(e=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal value: "+g+" (not an integer)")}g|=0;if("number"!==typeof e||0!==e%1){throw TypeError("Illegal offset: "+e+" (not an integer)")}e>>>=0;if(0>e||e+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}}var m=j.calculateVarint32(g);e+=m;var k=this.buffer.byteLength;e>k&&this.resize((k*=2)>e?k:e);e-=m;this.view.setUint8(e,m=g|128);g>>>=0;128<=g?(m=g>>7|128,this.view.setUint8(e+1,m),16384<=g?(m=g>>14|128,this.view.setUint8(e+2,m),2097152<=g?(m=g>>21|128,this.view.setUint8(e+3,m),268435456<=g?(this.view.setUint8(e+4,g>>28&15),m=5):(this.view.setUint8(e+3,m&127),m=4)):(this.view.setUint8(e+2,m&127),m=3)):(this.view.setUint8(e+1,m&127),m=2)):(this.view.setUint8(e,m&127),m=1);return s?(this.offset+=m,this):m};n.writeVarint32ZigZag=function(g,e){return this.writeVarint32(j.zigZagEncode32(g),e)};n.readVarint32=function(g){var e="undefined"===typeof g;e&&(g=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal offset: "+g+" (not an integer)")}g>>>=0;if(0>g||g+1>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+g+" (+1) <= "+this.buffer.byteLength)}}var s=0,m=0,k;do{k=g+s;if(!this.noAssert&&k>this.limit){throw g=Error("Truncated"),g.truncated=!0,g}k=this.view.getUint8(k);5>s&&(m|=(k&127)<<7*s>>>0);++s}while(128===(k&128));m|=0;return e?(this.offset+=s,m):{value:m,length:s}};n.readVarint32ZigZag=function(e){e=this.readVarint32(e);"object"===typeof e?e.value=j.zigZagDecode32(e.value):e=j.zigZagDecode32(e);return e};h&&(j.MAX_VARINT64_BYTES=10,j.calculateVarint64=function(g){"number"===typeof g&&(g=h.fromNumber(g));var e=g.toInt()>>>0,k=g.shiftRightUnsigned(28).toInt()>>>0;g=g.shiftRightUnsigned(56).toInt()>>>0;return 0==g?0==k?16384>e?128>e?1:2:2097152>e?3:4:16384>k?128>k?5:6:2097152>k?7:8:128>g?9:10},j.zigZagEncode64=function(e){"number"===typeof e?e=h.fromNumber(e,!1):!1!==e.unsigned&&(e=e.toSigned());return e.shiftLeft(1).xor(e.shiftRight(63)).toUnsigned()},j.zigZagDecode64=function(e){"number"===typeof e?e=h.fromNumber(e,!1):!1!==e.unsigned&&(e=e.toSigned());return e.shiftRightUnsigned(1).xor(e.and(h.ONE).toSigned().negate()).toSigned()},n.writeVarint64=function(k,g){var w="undefined"===typeof g;w&&(g=this.offset);if(!this.noAssert){if("number"===typeof k){k=h.fromNumber(k)}else{if(!(k&&k instanceof h)){throw TypeError("Illegal value: "+k+" (not an integer or Long)")}}if("number"!==typeof g||0!==g%1){throw TypeError("Illegal offset: "+g+" (not an integer)")}g>>>=0;if(0>g||g+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+g+" (+0) <= "+this.buffer.byteLength)}}"number"===typeof k?k=h.fromNumber(k,!1):!1!==k.unsigned&&(k=k.toSigned());var u=j.calculateVarint64(k),s=k.toInt()>>>0,v=k.shiftRightUnsigned(28).toInt()>>>0,t=k.shiftRightUnsigned(56).toInt()>>>0;g+=u;var m=this.buffer.byteLength;g>m&&this.resize((m*=2)>g?m:g);g-=u;switch(u){case 10:this.view.setUint8(g+9,t>>>7&1);case 9:this.view.setUint8(g+8,9!==u?t|128:t&127);case 8:this.view.setUint8(g+7,8!==u?v>>>21|128:v>>>21&127);case 7:this.view.setUint8(g+6,7!==u?v>>>14|128:v>>>14&127);case 6:this.view.setUint8(g+5,6!==u?v>>>7|128:v>>>7&127);case 5:this.view.setUint8(g+4,5!==u?v|128:v&127);case 4:this.view.setUint8(g+3,4!==u?s>>>21|128:s>>>21&127);case 3:this.view.setUint8(g+2,3!==u?s>>>14|128:s>>>14&127);case 2:this.view.setUint8(g+1,2!==u?s>>>7|128:s>>>7&127);case 1:this.view.setUint8(g,1!==u?s|128:s&127)}return w?(this.offset+=u,this):u},n.writeVarint64ZigZag=function(g,e){return this.writeVarint64(j.zigZagEncode64(g),e)},n.readVarint64=function(k){var g="undefined"===typeof k;g&&(k=this.offset);if(!this.noAssert){if("number"!==typeof k||0!==k%1){throw TypeError("Illegal offset: "+k+" (not an integer)")}k>>>=0;if(0>k||k+1>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+k+" (+1) <= "+this.buffer.byteLength)}}var v=k,u=0,s=0,t=0,m=0,m=this.view.getUint8(k++),u=m&127;if(m&128&&(m=this.view.getUint8(k++),u|=(m&127)<<7,m&128&&(m=this.view.getUint8(k++),u|=(m&127)<<14,m&128&&(m=this.view.getUint8(k++),u|=(m&127)<<21,m&128&&(m=this.view.getUint8(k++),s=m&127,m&128&&(m=this.view.getUint8(k++),s|=(m&127)<<7,m&128&&(m=this.view.getUint8(k++),s|=(m&127)<<14,m&128&&(m=this.view.getUint8(k++),s|=(m&127)<<21,m&128&&(m=this.view.getUint8(k++),t=m&127,m&128&&(m=this.view.getUint8(k++),t|=(m&127)<<7,m&128)))))))))){throw Error("Buffer overrun")}u=h.fromBits(u|s<<28,s>>>4|t<<24,!1);return g?(this.offset=k,u):{value:u,length:k-v}},n.readVarint64ZigZag=function(e){(e=this.readVarint64(e))&&e.value instanceof h?e.value=j.zigZagDecode64(e.value):e=j.zigZagDecode64(e);return e});n.writeCString=function(k,g){var u="undefined"===typeof g;u&&(g=this.offset);var t,m=k.length;if(!this.noAssert){if("string"!==typeof k){throw TypeError("Illegal str: Not a string")}for(t=0;t<m;++t){if(0===k.charCodeAt(t)){throw RangeError("Illegal str: Contains NULL-characters")}}if("number"!==typeof g||0!==g%1){throw TypeError("Illegal offset: "+g+" (not an integer)")}g>>>=0;if(0>g||g+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+g+" (+0) <= "+this.buffer.byteLength)}}t=g;m=f.a(c(k))[1];g+=m+1;var s=this.buffer.byteLength;g>s&&this.resize((s*=2)>g?s:g);g-=m+1;f.c(c(k),function(e){this.view.setUint8(g++,e)}.bind(this));this.view.setUint8(g++,0);return u?(this.offset=g-t,this):m};n.readCString=function(g){var e="undefined"===typeof g;e&&(g=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal offset: "+g+" (not an integer)")}g>>>=0;if(0>g||g+1>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+g+" (+1) <= "+this.buffer.byteLength)}}var s=g,m,k=-1;f.b(function(){if(0===k){return null}if(g>=this.limit){throw RangeError("Illegal range: Truncated data, "+g+" < "+this.limit)}return 0===(k=this.view.getUint8(g++))?null:k}.bind(this),m=q(),!0);return e?(this.offset=g,m()):{string:m(),length:g-s}};n.writeIString=function(k,g){var u="undefined"===typeof g;u&&(g=this.offset);if(!this.noAssert){if("string"!==typeof k){throw TypeError("Illegal str: Not a string")}if("number"!==typeof g||0!==g%1){throw TypeError("Illegal offset: "+g+" (not an integer)")}g>>>=0;if(0>g||g+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+g+" (+0) <= "+this.buffer.byteLength)}}var t=g,m;m=f.a(c(k),this.noAssert)[1];g+=4+m;var s=this.buffer.byteLength;g>s&&this.resize((s*=2)>g?s:g);g-=4+m;this.view.setUint32(g,m,this.littleEndian);g+=4;f.c(c(k),function(e){this.view.setUint8(g++,e)}.bind(this));if(g!==t+4+m){throw RangeError("Illegal range: Truncated data, "+g+" == "+(g+4+m))}return u?(this.offset=g,this):g-t};n.readIString=function(g){var e="undefined"===typeof g;e&&(g=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal offset: "+g+" (not an integer)")}g>>>=0;if(0>g||g+4>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+g+" (+4) <= "+this.buffer.byteLength)}}var s=0,m=g,s=this.view.getUint32(g,this.littleEndian);g+=4;var k=g+s;f.b(function(){return g<k?this.view.getUint8(g++):null}.bind(this),s=q(),this.noAssert);s=s();return e?(this.offset=g,s):{string:s,length:g-m}};j.METRICS_CHARS="c";j.METRICS_BYTES="b";n.writeUTF8String=function(k,g){var u="undefined"===typeof g;u&&(g=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal offset: "+g+" (not an integer)")}g>>>=0;if(0>g||g+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+g+" (+0) <= "+this.buffer.byteLength)}}var t,m=g;t=f.a(c(k))[1];g+=t;var s=this.buffer.byteLength;g>s&&this.resize((s*=2)>g?s:g);g-=t;f.c(c(k),function(e){this.view.setUint8(g++,e)}.bind(this));return u?(this.offset=g,this):g-m};n.writeString=n.writeUTF8String;j.calculateUTF8Chars=function(e){return f.a(c(e))[0]};j.calculateUTF8Bytes=function(e){return f.a(c(e))[1]};n.readUTF8String=function(k,g,w){"number"===typeof g&&(w=g,g=void 0);var v="undefined"===typeof w;v&&(w=this.offset);"undefined"===typeof g&&(g=j.METRICS_CHARS);if(!this.noAssert){if("number"!==typeof k||0!==k%1){throw TypeError("Illegal length: "+k+" (not an integer)")}k|=0;if("number"!==typeof w||0!==w%1){throw TypeError("Illegal offset: "+w+" (not an integer)")}w>>>=0;if(0>w||w+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+w+" (+0) <= "+this.buffer.byteLength)}}var t=0,u=w,m;if(g===j.METRICS_CHARS){m=q();f.g(function(){return t<k&&w<this.limit?this.view.getUint8(w++):null}.bind(this),function(e){++t;f.e(e,m)}.bind(this));if(t!==k){throw RangeError("Illegal range: Truncated data, "+t+" == "+k)}return v?(this.offset=w,m()):{string:m(),length:w-u}}if(g===j.METRICS_BYTES){if(!this.noAssert){if("number"!==typeof w||0!==w%1){throw TypeError("Illegal offset: "+w+" (not an integer)")}w>>>=0;if(0>w||w+k>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+w+" (+"+k+") <= "+this.buffer.byteLength)}}var s=w+k;f.b(function(){return w<s?this.view.getUint8(w++):null}.bind(this),m=q(),this.noAssert);if(w!==s){throw RangeError("Illegal range: Truncated data, "+w+" == "+s)}return v?(this.offset=w,m()):{string:m(),length:w-u}}throw TypeError("Unsupported metrics: "+g)};n.readString=n.readUTF8String;n.writeVString=function(k,g){var v="undefined"===typeof g;v&&(g=this.offset);if(!this.noAssert){if("string"!==typeof k){throw TypeError("Illegal str: Not a string")}if("number"!==typeof g||0!==g%1){throw TypeError("Illegal offset: "+g+" (not an integer)")}g>>>=0;if(0>g||g+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+g+" (+0) <= "+this.buffer.byteLength)}}var u=g,s,t;s=f.a(c(k),this.noAssert)[1];t=j.calculateVarint32(s);g+=t+s;var m=this.buffer.byteLength;g>m&&this.resize((m*=2)>g?m:g);g-=t+s;g+=this.writeVarint32(s,g);f.c(c(k),function(e){this.view.setUint8(g++,e)}.bind(this));if(g!==u+s+t){throw RangeError("Illegal range: Truncated data, "+g+" == "+(g+s+t))}return v?(this.offset=g,this):g-u};n.readVString=function(g){var e="undefined"===typeof g;e&&(g=this.offset);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal offset: "+g+" (not an integer)")}g>>>=0;if(0>g||g+1>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+g+" (+1) <= "+this.buffer.byteLength)}}var s=this.readVarint32(g),m=g;g+=s.length;var s=s.value,k=g+s,s=q();f.b(function(){return g<k?this.view.getUint8(g++):null}.bind(this),s,this.noAssert);s=s();return e?(this.offset=g,s):{string:s,length:g-m}};n.append=function(g,e,s){if("number"===typeof e||"string"!==typeof e){s=e,e=void 0}var m="undefined"===typeof s;m&&(s=this.offset);if(!this.noAssert){if("number"!==typeof s||0!==s%1){throw TypeError("Illegal offset: "+s+" (not an integer)")}s>>>=0;if(0>s||s+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+s+" (+0) <= "+this.buffer.byteLength)}}g instanceof j||(g=j.wrap(g,e));e=g.limit-g.offset;if(0>=e){return this}s+=e;var k=this.buffer.byteLength;s>k&&this.resize((k*=2)>s?k:s);(new Uint8Array(this.buffer,s-e)).set((new Uint8Array(g.buffer)).subarray(g.offset,g.limit));g.offset+=e;m&&(this.offset+=e);return this};n.appendTo=function(g,e){g.append(this,e);return this};n.assert=function(e){this.noAssert=!e;return this};n.capacity=function(){return this.buffer.byteLength};n.clear=function(){this.offset=0;this.limit=this.buffer.byteLength;this.markedOffset=-1;return this};n.clone=function(g){var e=new j(0,this.littleEndian,this.noAssert);g?(g=new ArrayBuffer(this.buffer.byteLength),(new Uint8Array(g)).set(this.buffer),e.buffer=g,e.view=new DataView(g)):(e.buffer=this.buffer,e.view=this.view);e.offset=this.offset;e.markedOffset=this.markedOffset;e.limit=this.limit;return e};n.compact=function(g,e){"undefined"===typeof g&&(g=this.offset);"undefined"===typeof e&&(e=this.limit);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal begin: Not an integer")}g>>>=0;if("number"!==typeof e||0!==e%1){throw TypeError("Illegal end: Not an integer")}e>>>=0;if(0>g||g>e||e>this.buffer.byteLength){throw RangeError("Illegal range: 0 <= "+g+" <= "+e+" <= "+this.buffer.byteLength)}}if(0===g&&e===this.buffer.byteLength){return this}var m=e-g;if(0===m){return this.buffer=r,this.view=null,0<=this.markedOffset&&(this.markedOffset-=g),this.limit=this.offset=0,this}var k=new ArrayBuffer(m);(new Uint8Array(k)).set((new Uint8Array(this.buffer)).subarray(g,e));this.buffer=k;this.view=new DataView(k);0<=this.markedOffset&&(this.markedOffset-=g);this.offset=0;this.limit=m;return this};n.copy=function(g,e){"undefined"===typeof g&&(g=this.offset);"undefined"===typeof e&&(e=this.limit);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal begin: Not an integer")}g>>>=0;if("number"!==typeof e||0!==e%1){throw TypeError("Illegal end: Not an integer")}e>>>=0;if(0>g||g>e||e>this.buffer.byteLength){throw RangeError("Illegal range: 0 <= "+g+" <= "+e+" <= "+this.buffer.byteLength)}}if(g===e){return new j(0,this.littleEndian,this.noAssert)}var m=e-g,k=new j(m,this.littleEndian,this.noAssert);k.offset=0;k.limit=m;0<=k.markedOffset&&(k.markedOffset-=g);this.copyTo(k,0,g,e);return k};n.copyTo=function(k,g,v,u){var s,t;if(!this.noAssert&&!j.isByteBuffer(k)){throw TypeError("Illegal target: Not a ByteBuffer")}g=(t="undefined"===typeof g)?k.offset:g|0;v=(s="undefined"===typeof v)?this.offset:v|0;u="undefined"===typeof u?this.limit:u|0;if(0>g||g>k.buffer.byteLength){throw RangeError("Illegal target range: 0 <= "+g+" <= "+k.buffer.byteLength)}if(0>v||u>this.buffer.byteLength){throw RangeError("Illegal source range: 0 <= "+v+" <= "+this.buffer.byteLength)}var m=u-v;if(0===m){return k}k.ensureCapacity(g+m);(new Uint8Array(k.buffer)).set((new Uint8Array(this.buffer)).subarray(v,u),g);s&&(this.offset+=m);t&&(k.offset+=m);return this};n.ensureCapacity=function(g){var e=this.buffer.byteLength;return e<g?this.resize((e*=2)>g?e:g):this};n.fill=function(g,e,m){var k="undefined"===typeof e;k&&(e=this.offset);"string"===typeof g&&0<g.length&&(g=g.charCodeAt(0));"undefined"===typeof e&&(e=this.offset);"undefined"===typeof m&&(m=this.limit);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal value: "+g+" (not an integer)")}g|=0;if("number"!==typeof e||0!==e%1){throw TypeError("Illegal begin: Not an integer")}e>>>=0;if("number"!==typeof m||0!==m%1){throw TypeError("Illegal end: Not an integer")}m>>>=0;if(0>e||e>m||m>this.buffer.byteLength){throw RangeError("Illegal range: 0 <= "+e+" <= "+m+" <= "+this.buffer.byteLength)}}if(e>=m){return this}for(;e<m;){this.view.setUint8(e++,g)}k&&(this.offset=e);return this};n.flip=function(){this.limit=this.offset;this.offset=0;return this};n.mark=function(e){e="undefined"===typeof e?this.offset:e;if(!this.noAssert){if("number"!==typeof e||0!==e%1){throw TypeError("Illegal offset: "+e+" (not an integer)")}e>>>=0;if(0>e||e+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}}this.markedOffset=e;return this};n.order=function(e){if(!this.noAssert&&"boolean"!==typeof e){throw TypeError("Illegal littleEndian: Not a boolean")}this.littleEndian=!!e;return this};n.LE=function(e){this.littleEndian="undefined"!==typeof e?!!e:!0;return this};n.BE=function(e){this.littleEndian="undefined"!==typeof e?!e:!1;return this};n.prepend=function(k,g,v){if("number"===typeof g||"string"!==typeof g){v=g,g=void 0}var u="undefined"===typeof v;u&&(v=this.offset);if(!this.noAssert){if("number"!==typeof v||0!==v%1){throw TypeError("Illegal offset: "+v+" (not an integer)")}v>>>=0;if(0>v||v+0>this.buffer.byteLength){throw RangeError("Illegal offset: 0 <= "+v+" (+0) <= "+this.buffer.byteLength)}}k instanceof j||(k=j.wrap(k,g));g=k.limit-k.offset;if(0>=g){return this}var s=g-v,t;if(0<s){var m=new ArrayBuffer(this.buffer.byteLength+s);t=new Uint8Array(m);t.set((new Uint8Array(this.buffer)).subarray(v,this.buffer.byteLength),g);this.buffer=m;this.view=new DataView(m);this.offset+=s;0<=this.markedOffset&&(this.markedOffset+=s);this.limit+=s;v+=s}else{t=new Uint8Array(this.buffer)}t.set((new Uint8Array(k.buffer)).subarray(k.offset,k.limit),v-g);k.offset=k.limit;u&&(this.offset-=g);return this};n.prependTo=function(g,e){g.prepend(this,e);return this};n.printDebug=function(e){"function"!==typeof e&&(e=console.log.bind(console));e(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))};n.remaining=function(){return this.limit-this.offset};n.reset=function(){0<=this.markedOffset?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0;return this};n.resize=function(e){if(!this.noAssert){if("number"!==typeof e||0!==e%1){throw TypeError("Illegal capacity: "+e+" (not an integer)")}e|=0;if(0>e){throw RangeError("Illegal capacity: 0 <= "+e)}}this.buffer.byteLength<e&&(e=new ArrayBuffer(e),(new Uint8Array(e)).set(new Uint8Array(this.buffer)),this.buffer=e,this.view=new DataView(e));return this};n.reverse=function(g,e){"undefined"===typeof g&&(g=this.offset);"undefined"===typeof e&&(e=this.limit);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal begin: Not an integer")}g>>>=0;if("number"!==typeof e||0!==e%1){throw TypeError("Illegal end: Not an integer")}e>>>=0;if(0>g||g>e||e>this.buffer.byteLength){throw RangeError("Illegal range: 0 <= "+g+" <= "+e+" <= "+this.buffer.byteLength)}}if(g===e){return this}Array.prototype.reverse.call((new Uint8Array(this.buffer)).subarray(g,e));this.view=new DataView(this.buffer);return this};n.skip=function(g){if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal length: "+g+" (not an integer)")}g|=0}var e=this.offset+g;if(!this.noAssert&&(0>e||e>this.buffer.byteLength)){throw RangeError("Illegal length: 0 <= "+this.offset+" + "+g+" <= "+this.buffer.byteLength)}this.offset=e;return this};n.slice=function(g,e){"undefined"===typeof g&&(g=this.offset);"undefined"===typeof e&&(e=this.limit);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal begin: Not an integer")}g>>>=0;if("number"!==typeof e||0!==e%1){throw TypeError("Illegal end: Not an integer")}e>>>=0;if(0>g||g>e||e>this.buffer.byteLength){throw RangeError("Illegal range: 0 <= "+g+" <= "+e+" <= "+this.buffer.byteLength)}}var k=this.clone();k.offset=g;k.limit=e;return k};n.toBuffer=function(g){var e=this.offset,m=this.limit;if(e>m){var k=e,e=m,m=k}if(!this.noAssert){if("number"!==typeof e||0!==e%1){throw TypeError("Illegal offset: Not an integer")}e>>>=0;if("number"!==typeof m||0!==m%1){throw TypeError("Illegal limit: Not an integer")}m>>>=0;if(0>e||e>m||m>this.buffer.byteLength){throw RangeError("Illegal range: 0 <= "+e+" <= "+m+" <= "+this.buffer.byteLength)}}if(!g&&0===e&&m===this.buffer.byteLength){return this.buffer}if(e===m){return r}g=new ArrayBuffer(m-e);(new Uint8Array(g)).set((new Uint8Array(this.buffer)).subarray(e,m),0);return g};n.toArrayBuffer=n.toBuffer;n.toString=function(g,e,k){if("undefined"===typeof g){return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")"}"number"===typeof g&&(k=e=g="utf8");switch(g){case"utf8":return this.toUTF8(e,k);case"base64":return this.toBase64(e,k);case"hex":return this.toHex(e,k);case"binary":return this.toBinary(e,k);case"debug":return this.toDebug();case"columns":return this.m();default:throw Error("Unsupported encoding: "+g)}};var o=function(){for(var g={},e=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],s=[],m=0,k=e.length;m<k;++m){s[e[m]]=m}g.i=function(t,w){for(var v,u;null!==(v=t());){w(e[v>>2&63]),u=(v&3)<<4,null!==(v=t())?(u|=v>>4&15,w(e[(u|v>>4&15)&63]),u=(v&15)<<2,null!==(v=t())?(w(e[(u|v>>6&3)&63]),w(e[v&63])):(w(e[u&63]),w(61))):(w(e[u&63]),w(61),w(61))}};g.h=function(u,t){function y(z){throw Error("Illegal character code: "+z)}for(var w,x,v;null!==(w=u());){if(x=s[w],"undefined"===typeof x&&y(w),null!==(w=u())&&(v=s[w],"undefined"===typeof v&&y(w),t(x<<2>>>0|(v&48)>>4),null!==(w=u()))){x=s[w];if("undefined"===typeof x){if(61===w){break}else{y(w)}}t((v&15)<<4>>>0|(x&60)>>2);if(null!==(w=u())){v=s[w];if("undefined"===typeof v){if(61===w){break}else{y(w)}}t((x&3)<<6>>>0|v)}}}};g.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)};return g}();n.toBase64=function(g,e){"undefined"===typeof g&&(g=this.offset);"undefined"===typeof e&&(e=this.limit);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal begin: Not an integer")}g>>>=0;if("number"!==typeof e||0!==e%1){throw TypeError("Illegal end: Not an integer")}e>>>=0;if(0>g||g>e||e>this.buffer.byteLength){throw RangeError("Illegal range: 0 <= "+g+" <= "+e+" <= "+this.buffer.byteLength)}}var k;o.i(function(){return g<e?this.view.getUint8(g++):null}.bind(this),k=q());return k()};j.fromBase64=function(g,e,s){if(!s){if("string"!==typeof g){throw TypeError("Illegal str: Not a string")}if(0!==g.length%4){throw TypeError("Illegal str: Length not a multiple of 4")}}var m=new j(g.length/4*3,e,s),k=0;o.h(c(g),function(t){m.view.setUint8(k++,t)});m.limit=k;return m};j.btoa=function(e){return j.fromBinary(e).toBase64()};j.atob=function(e){return j.fromBase64(e).toBinary()};n.toBinary=function(g,e){g="undefined"===typeof g?this.offset:g;e="undefined"===typeof e?this.limit:e;if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal begin: Not an integer")}g>>>=0;if("number"!==typeof e||0!==e%1){throw TypeError("Illegal end: Not an integer")}e>>>=0;if(0>g||g>e||e>this.buffer.byteLength){throw RangeError("Illegal range: 0 <= "+g+" <= "+e+" <= "+this.buffer.byteLength)}}if(g===e){return""}for(var m=[],k=[];g<e;){m.push(this.view.getUint8(g++)),1024<=m.length&&(k.push(String.fromCharCode.apply(String,m)),m=[])}return k.join("")+String.fromCharCode.apply(String,m)};j.fromBinary=function(k,g,u){if(!u&&"string"!==typeof k){throw TypeError("Illegal str: Not a string")}for(var t=0,m=k.length,s=new j(m,g,u);t<m;){g=k.charCodeAt(t);if(!u&&255<g){throw RangeError("Illegal charCode at "+t+": 0 <= "+g+" <= 255")}s.view.setUint8(t++,g)}s.limit=m;return s};n.toDebug=function(m){for(var k=-1,w=this.buffer.byteLength,v,t="",u="",s="";k<w;){-1!==k&&(v=this.view.getUint8(k),t=16>v?t+("0"+v.toString(16).toUpperCase()):t+v.toString(16).toUpperCase(),m&&(u+=32<v&&127>v?String.fromCharCode(v):"."));++k;if(m&&0<k&&0===k%16&&k!==w){for(;51>t.length;){t+=" "}s+=t+u+"\n";t=u=""}t=k===this.offset&&k===this.limit?t+(k===this.markedOffset?"!":"|"):k===this.offset?t+(k===this.markedOffset?"[":"<"):k===this.limit?t+(k===this.markedOffset?"]":">"):t+(k===this.markedOffset?"'":m||0!==k&&k!==w?" ":"")}if(m&&" "!==t){for(;51>t.length;){t+=" "}s+=t+u+"\n"}return m?s:t};j.fromDebug=function(C,B,A){var z=C.length;B=new j((z+1)/3|0,B,A);for(var x=0,y=0,w,v=!1,u=!1,t=!1,g=!1,s=!1;x<z;){switch(w=C.charAt(x++)){case"!":if(!A){if(u||t||g){s=!0;break}u=t=g=!0}B.offset=B.markedOffset=B.limit=y;v=!1;break;case"|":if(!A){if(u||g){s=!0;break}u=g=!0}B.offset=B.limit=y;v=!1;break;case"[":if(!A){if(u||t){s=!0;break}u=t=!0}B.offset=B.markedOffset=y;v=!1;break;case"<":if(!A){if(u){s=!0;break}u=!0}B.offset=y;v=!1;break;case"]":if(!A){if(g||t){s=!0;break}g=t=!0}B.limit=B.markedOffset=y;v=!1;break;case">":if(!A){if(g){s=!0;break}g=!0}B.limit=y;v=!1;break;case"'":if(!A){if(t){s=!0;break}t=!0}B.markedOffset=y;v=!1;break;case" ":v=!1;break;default:if(!A&&v){s=!0;break}w=parseInt(w+C.charAt(x++),16);if(!A&&(isNaN(w)||0>w||255<w)){throw TypeError("Illegal str: Not a debug encoded string")}B.view.setUint8(y++,w);v=!0}if(s){throw TypeError("Illegal str: Invalid symbol at "+x)}}if(!A){if(!u||!g){throw TypeError("Illegal str: Missing offset or limit")}if(y<B.buffer.byteLength){throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+y+" < "+z)}}return B};n.toHex=function(g,e){g="undefined"===typeof g?this.offset:g;e="undefined"===typeof e?this.limit:e;if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal begin: Not an integer")}g>>>=0;if("number"!==typeof e||0!==e%1){throw TypeError("Illegal end: Not an integer")}e>>>=0;if(0>g||g>e||e>this.buffer.byteLength){throw RangeError("Illegal range: 0 <= "+g+" <= "+e+" <= "+this.buffer.byteLength)}}for(var m=Array(e-g),k;g<e;){k=this.view.getUint8(g++),16>k?m.push("0",k.toString(16)):m.push(k.toString(16))}return m.join("")};j.fromHex=function(k,g,v){if(!v){if("string"!==typeof k){throw TypeError("Illegal str: Not a string")}if(0!==k.length%2){throw TypeError("Illegal str: Length not a multiple of 2")}}var u=k.length;g=new j(u/2|0,g);for(var s,t=0,m=0;t<u;t+=2){s=parseInt(k.substring(t,t+2),16);if(!v&&(!isFinite(s)||0>s||255<s)){throw TypeError("Illegal str: Contains non-hex characters")}g.view.setUint8(m++,s)}g.limit=m;return g};var f=function(){var e={k:1114111,j:function(g,m){var k=null;"number"===typeof g&&(k=g,g=function(){return null});for(;null!==k||null!==(k=g());){128>k?m(k&127):(2048>k?m(k>>6&31|192):(65536>k?m(k>>12&15|224):(m(k>>18&7|240),m(k>>12&63|128)),m(k>>6&63|128)),m(k&63|128)),k=null}},g:function(m,x){function w(k){k=k.slice(0,k.indexOf(null));var g=Error(k.toString());g.name="TruncatedError";g.bytes=k;throw g}for(var v,u,t,s;null!==(v=m());){if(0===(v&128)){x(v)}else{if(192===(v&224)){null===(u=m())&&w([v,u]),x((v&31)<<6|u&63)}else{if(224===(v&240)){null!==(u=m())&&null!==(t=m())||w([v,u,t]),x((v&15)<<12|(u&63)<<6|t&63)}else{if(240===(v&248)){null!==(u=m())&&null!==(t=m())&&null!==(s=m())||w([v,u,t,s]),x((v&7)<<18|(u&63)<<12|(t&63)<<6|s&63)}else{throw RangeError("Illegal starting byte: "+v)}}}}}},d:function(g,s){for(var m,k=null;null!==(m=null!==k?k:g());){55296<=m&&57343>=m&&null!==(k=g())&&56320<=k&&57343>=k?(s(1024*(m-55296)+k-56320+65536),k=null):s(m)}null!==k&&s(k)},e:function(g,m){var k=null;"number"===typeof g&&(k=g,g=function(){return null});for(;null!==k||null!==(k=g());){65535>=k?m(k):(k-=65536,m((k>>10)+55296),m(k%1024+56320)),k=null}},c:function(g,k){e.d(g,function(m){e.j(m,k)})},b:function(g,k){e.g(g,function(m){e.e(m,k)})},f:function(g){return 128>g?1:2048>g?2:65536>g?3:4},l:function(g){for(var m,k=0;null!==(m=g());){k+=e.f(m)}return k},a:function(g){var m=0,k=0;e.d(g,function(s){++m;k+=e.f(s)});return[m,k]}};return e}();n.toUTF8=function(g,e){"undefined"===typeof g&&(g=this.offset);"undefined"===typeof e&&(e=this.limit);if(!this.noAssert){if("number"!==typeof g||0!==g%1){throw TypeError("Illegal begin: Not an integer")}g>>>=0;if("number"!==typeof e||0!==e%1){throw TypeError("Illegal end: Not an integer")}e>>>=0;if(0>g||g>e||e>this.buffer.byteLength){throw RangeError("Illegal range: 0 <= "+g+" <= "+e+" <= "+this.buffer.byteLength)}}var m;try{f.b(function(){return g<e?this.view.getUint8(g++):null}.bind(this),m=q())}catch(k){if(g!==e){throw RangeError("Illegal range: Truncated data, "+g+" != "+e)}}return m()};j.fromUTF8=function(k,g,t){if(!t&&"string"!==typeof k){throw TypeError("Illegal str: Not a string")}var s=new j(f.a(c(k),!0)[1],g,t),m=0;f.c(c(k),function(e){s.view.setUint8(m++,e)});s.limit=m;return s};return j}"function"===typeof require&&"object"===typeof module&&module&&"object"===typeof exports&&exports?module.exports=function(){var c;try{c=require("long")}catch(e){}return a(c)}():"function"===typeof define&&define.amd?define("ByteBuffer",["Long"],function(c){return a(c)}):(b.dcodeIO=b.dcodeIO||{}).ByteBuffer=a(b.dcodeIO.Long)})(this);