var webSocketURL="ws://localhost:8080/map-app/websocket";var webSocket=null;var logCounter=0;function onWebSocketOpen(){addLogRecord("Connection done","WS");var a=$nme.newSession("query");sendOnWebSocket(a)}function onWebSocketMessage(a){addLogRecord("Message: "+a.data,"WS");parseSocketData(a.data)}function onWebSocketError(a){addLogRecord("Error: "+a,"WS")}function onWebSocketClose(){addLogRecord("Closing","WS")}function sendOnWebSocket(b){if(webSocket!==null){var a=JSON.stringify(b);webSocket.send(a);addLogRecord(a,"WS")}else{addLogRecord("No WS connection available.","WS")}}function connectToWebSocket(){if(webSocket===null){webSocket=new WebSocket(webSocketURL);webSocket.onopen=onWebSocketOpen;webSocket.onmessage=function(a){onWebSocketMessage(a)};webSocket.onerror=function(a){onWebSocketError(a)};webSocket.onclose=onWebSocketClose}}function onDisconnect(){if(webSocket!==null){webSocket.close();webSocket=null}}function addLogRecord(b,a){console.log("["+a+"-"+logCounter+"] "+b);logCounter++}function parseSocketData(a){var b=JSON.parse(a);switch(b.objectType){case ObjectType.MAPQUEST:reqMapQuest(b);break;case ObjectType.OPENSTREETMAP:reqOpenStreetMap(b);break;case ObjectType.LAYER_SEL:reqLayerSelection(b);break;case ObjectType.LAYER_DEL:reqLayerDeletion(b);break;case ObjectType.LAYER_TOGGLE:reqLayerToggle(b);break;case ObjectType.CENTER:reqCenter(b);break;case ObjectType.ROTATE:reqRotation(b);break;case ObjectType.ZOOM:reqZoom(b);break;case ObjectType.FEAT_DRAW:reqFeatDraw(b);break;case ObjectType.FEAT_POINT:reqFeatPoint(b);break;case ObjectType.FEAT_LINE:reqFeatLine(b);break;case ObjectType.FEAT_POLYGON:reqFeatPolygon(b);break;case ObjectType.CIRCLE:reqCircle(b);break;case ObjectType.CONTROLS:reqControls(b);break;case ObjectType.SESSION:reqGetSession(b);break;case ObjectType.CONFIGURATION:reqConfig(b);break;default:break}}function reqGetSession(b){var a=b.value;$nme.setSession(a)}function reqControls(a){}function reqMapQuest(a){}function reqOpenStreetMap(a){}function reqLayerSelection(a){}function reqLayerDeletion(a){}function reqLayerToggle(a){}function reqCenter(a){}function reqRotation(a){}function reqZoom(a){}function reqFeatDraw(a){}function reqFeatPoint(a){}function reqFeatLine(a){}function reqFeatPolygon(a){}function reqCircle(a){};